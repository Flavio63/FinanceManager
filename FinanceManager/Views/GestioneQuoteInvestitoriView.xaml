<UserControl x:Class="FinanceManager.Views.GestioneQuoteInvestitoriView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:is="http://schemas.microsoft.com/expression/2010/interactions"
             xmlns:iy="http://schemas.microsoft.com/expression/2010/interactivity"
             xmlns:conv="clr-namespace:FinanceManager.Events"
             xmlns:local="clr-namespace:FinanceManager.Views"
             mc:Ignorable="d" Name="_GestioneQuoteInvestitoriView"
             d:DesignHeight="650" d:DesignWidth="1000">
    <UserControl.Resources>
        <conv:ComboboxDisableConverter x:Key="itemDisableconverter"/>
        <TextBlock Text="GestioneQuote" x:Key="ObjName"/>
    </UserControl.Resources>
    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Hidden">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="50"/>
                <RowDefinition Height="auto"/>
                <RowDefinition Height="50"/>
                <RowDefinition Height="auto"/>
                <RowDefinition Height="50"/>
                <RowDefinition Height="auto"/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="0.30*"/>
                <ColumnDefinition Width="50"/>
            </Grid.ColumnDefinitions>
            <TextBlock Grid.ColumnSpan="2" VerticalAlignment="Center" HorizontalAlignment="Center" FontSize="26" FontWeight="Bold">
                DISPONIBILITA' E QUOTE PER INVESTITORE
            </TextBlock>
            <Button Content="X" Command="{Binding CloseMeCommand}" 
                CommandParameter="{Binding ElementName=_GestioneQuoteInvestitoriView}" 
                HorizontalContentAlignment="Center" Grid.Column="2" HorizontalAlignment="Right"
                    VerticalContentAlignment="Center" Width="25" Height="25"
                Margin="0,0, 15, 0"/>

            <DataGrid Grid.Row="1"  ItemsSource="{Binding ListQuote, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" 
                      AlternatingRowBackground="LightGray" Margin="5"
                      AutoGenerateColumns="False" RowHeaderWidth="10" ColumnHeaderHeight="40" FontSize="25" FontWeight="Bold" CanUserAddRows="False" CanUserDeleteRows="False">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Investitore" Binding="{Binding NomeInvestitore, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                                        IsReadOnly="True" FontSize="22" FontWeight="Bold" MinWidth="170"/>
                    <DataGridTextColumn Header="Disponibilità" Binding="{Binding Ammontare, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay, 
                        ConverterCulture=it-IT, StringFormat=C2}" IsReadOnly="True" FontSize="22" FontWeight="Bold" MinWidth="180">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="{x:Type TextBlock}">
                                <Setter Property="HorizontalAlignment" Value="Right"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Quote" Binding="{Binding Quota, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay, 
                        ConverterCulture=it-IT, StringFormat={}{0}%}" IsReadOnly="True" FontSize="22" FontWeight="Bold" MinWidth="120">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="{x:Type TextBlock}">
                                <Setter Property="HorizontalAlignment" Value="Right"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Totale" Binding="{Binding Totale, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay, 
                        ConverterCulture=it-IT, StringFormat=C2}" IsReadOnly="True" FontSize="22" FontWeight="Bold" MinWidth="180">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="{x:Type TextBlock}">
                                <Setter Property="HorizontalAlignment" Value="Right"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                </DataGrid.Columns>
            </DataGrid>

            <TextBlock Grid.Row="2" Grid.ColumnSpan="3" Text="GESTIONE QUOTE - Verificare, Modificare, Inserire ed Eliminare" VerticalAlignment="Center" HorizontalAlignment="Center" 
                         FontSize="22" FontWeight="Bold"/>
            <DataGrid Grid.Row="3" Grid.ColumnSpan="3" Name="TabQuote" 
                      ItemsSource="{Binding ListTabQuote, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                      AlternatingRowBackground="LightGray" Margin="5" AutoGenerateColumns="False"  
                      FontSize="18" FontWeight="Bold" CanUserAddRows="True" CanUserDeleteRows="True">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="ID" Binding="{Binding IdQuote, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                                        IsReadOnly="True" FontSize="14" FontWeight="Normal">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="{x:Type TextBlock}">
                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                <Setter Property="Padding" Value="0,0,5,0"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridComboBoxColumn Header="Investitore" IsReadOnly="False" SelectedValuePath="IdInvestitore" DisplayMemberPath="NomeInvestitore"
                                        SelectedValueBinding="{Binding IdInvestitore, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}">
                        <DataGridComboBoxColumn.ElementStyle>
                            <Style TargetType="ComboBox">
                                <Setter Property="ItemsSource" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=DataContext.ListInvestitore}"/>
                                <Setter Property="FontSize" Value="14"/>
                                <Setter Property="FontWeight" Value="Normal"/>
                            </Style>
                        </DataGridComboBoxColumn.ElementStyle>
                        <DataGridComboBoxColumn.EditingElementStyle>
                            <Style TargetType="ComboBox">
                                <Setter Property="ItemsSource" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=DataContext.ListInvestitore}"/>
                                <Setter Property="FontSize" Value="14"/>
                                <Setter Property="FontWeight" Value="Normal"/>
                            </Style>
                        </DataGridComboBoxColumn.EditingElementStyle>
                    </DataGridComboBoxColumn>
                    <DataGridComboBoxColumn Header="Movimento" IsReadOnly="False" SelectedValuePath="Id_tipo_movimento" DisplayMemberPath="Desc_tipo_movimento"
                                        SelectedValueBinding="{Binding Id_tipo_movimento, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}">
                        <DataGridComboBoxColumn.ElementStyle>
                            <Style TargetType="ComboBox">
                                <Setter Property="ItemsSource" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=DataContext.ListMovementType}"/>
                                <Setter Property="FontSize" Value="14"/>
                                <Setter Property="FontWeight" Value="Normal"/>
                            </Style>
                        </DataGridComboBoxColumn.ElementStyle>
                        <DataGridComboBoxColumn.EditingElementStyle>
                            <Style TargetType="ComboBox">
                                <Setter Property="ItemsSource" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=DataContext.ListMovementType}"/>
                                <Setter Property="FontSize" Value="14"/>
                                <Setter Property="FontWeight" Value="Normal"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding Path=Content, RelativeSource={RelativeSource Self}, 
                                Converter={StaticResource itemDisableconverter}, ConverterParameter={StaticResource ObjName}}" Value="true">
                                        <Setter Property="IsEnabled" Value="False"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </DataGridComboBoxColumn.EditingElementStyle>
                    </DataGridComboBoxColumn>
                    <DataGridTextColumn Header="Data" Binding="{Binding DataMovimento, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay, StringFormat=d, ConverterCulture=it-IT}"
                                        IsReadOnly="False" FontSize="14" FontWeight="Normal">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="{x:Type TextBlock}">
                                <Setter Property="HorizontalAlignment" Value="Right"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Ammontare" Binding="{Binding Ammontare, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay,
                                        ConverterCulture=it-IT, StringFormat=C2}" IsReadOnly="False" FontSize="14" FontWeight="Normal">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="{x:Type TextBlock}">
                                <Setter Property="HorizontalAlignment" Value="Right"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Note" Binding="{Binding Note, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                                        IsReadOnly="False"  FontSize="14" FontWeight="Normal"/>
                </DataGrid.Columns>
                <iy:Interaction.Triggers>
                    <iy:EventTrigger EventName="SelectionChanged">
                        <is:CallMethodAction TargetObject="{Binding}" MethodName="CbSelectionChanged"/>
                    </iy:EventTrigger>
                    <iy:EventTrigger EventName="RowEditEnding">
                        <is:CallMethodAction TargetObject="{Binding}" MethodName="RowChanged"/>
                    </iy:EventTrigger>
                    <iy:EventTrigger EventName="PreviewKeyDown">
                        <is:CallMethodAction TargetObject="{Binding}" MethodName="DeleteRow"/>
                    </iy:EventTrigger>
                    <iy:EventTrigger EventName="AddingNewItem">
                        <is:CallMethodAction TargetObject="{Binding}" MethodName="StartNewRow"/>
                    </iy:EventTrigger>
                </iy:Interaction.Triggers>
            </DataGrid>
            <TextBlock Grid.Row="4" Grid.ColumnSpan="3" Text="CONTO CORRENTE - Verificare, Modificare, Inserire ed Eliminare" VerticalAlignment="Center" HorizontalAlignment="Center" 
                         FontSize="22" FontWeight="Bold" Visibility="{Binding Visibility2, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"/>
            <DataGrid Grid.Row="5" Grid.ColumnSpan="3" Visibility="{Binding Visibility2, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                  ItemsSource="{Binding ListContoCorrente, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                  AlternatingRowBackground="LightGray" Margin="5" AutoGenerateColumns="False" FontSize="18" FontWeight="Bold" 
                  CanUserAddRows="False" CanUserDeleteRows="False">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="ID" Binding="{Binding Id_RowConto, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                                        IsReadOnly="True" FontSize="14" FontWeight="Normal">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="{x:Type TextBlock}">
                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                <Setter Property="Padding" Value="0,0,5,0"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Conto Corrente in" Binding="{Binding Desc_Conto, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay, StringFormat=d, ConverterCulture=it-IT}"
                                        IsReadOnly="False" FontSize="18" FontWeight="Bold">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="{x:Type TextBlock}">
                                <Setter Property="HorizontalAlignment" Value="Right"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Valuta" Binding="{Binding Cod_Valuta, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay, StringFormat=d, ConverterCulture=it-IT}"
                                        IsReadOnly="False" FontSize="14" FontWeight="Normal">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="{x:Type TextBlock}">
                                <Setter Property="HorizontalAlignment" Value="Right"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridComboBoxColumn Header="Movimento" IsReadOnly="False" SelectedValuePath="Id_tipo_movimento" DisplayMemberPath="Desc_tipo_movimento"
                                        SelectedValueBinding="{Binding IdMovimento, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}">
                        <DataGridComboBoxColumn.ElementStyle>
                            <Style TargetType="ComboBox">
                                <Setter Property="ItemsSource" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=DataContext.ListMovementType}"/>
                            </Style>
                        </DataGridComboBoxColumn.ElementStyle>
                        <DataGridComboBoxColumn.EditingElementStyle>
                            <Style TargetType="ComboBox">
                                <Setter Property="ItemsSource" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=DataContext.ListMovementType}"/>
                            </Style>
                        </DataGridComboBoxColumn.EditingElementStyle>
                    </DataGridComboBoxColumn>
                    <DataGridTextColumn Header="Gestione" Binding="{Binding NomeGestione, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay, StringFormat=d, ConverterCulture=it-IT}"
                                        IsReadOnly="False" FontSize="14" FontWeight="Normal">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="{x:Type TextBlock}">
                                <Setter Property="HorizontalAlignment" Value="Right"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Data" Binding="{Binding DataMovimento, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay, StringFormat=d, ConverterCulture=it-IT}"
                                        IsReadOnly="False" FontSize="14" FontWeight="Normal">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="{x:Type TextBlock}">
                                <Setter Property="HorizontalAlignment" Value="Right"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Ammontare" Binding="{Binding Ammontare, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay,
                                        ConverterCulture=it-IT, StringFormat=C2}" IsReadOnly="False" FontSize="14" FontWeight="Normal">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="{x:Type TextBlock}">
                                <Setter Property="HorizontalAlignment" Value="Right"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Note" Binding="{Binding Causale, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                                        IsReadOnly="False" FontSize="14" FontWeight="Normal"/>
                </DataGrid.Columns>
            </DataGrid>
            <!--<StackPanel Grid.Row="1" Grid.Column="2" Orientation="Vertical" Margin="5" VerticalAlignment="Center" HorizontalAlignment="Right">
            <Button Content="Inserisci" Command="{Binding OkCommand}" CommandParameter="{Binding ElementName=RadioButtonGroup}" Margin="5" FontSize="16" FontWeight="Bold" Height="55"/>
            <Button Content="Cancella" Command="{Binding EraseCommand}" CommandParameter="{Binding ElementName=TabQuote}" Margin="5" FontSize="16" FontWeight="Bold" Height="55"
                    Visibility="{Binding Visibility4, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"/>
            <Button Content="Pulisci" Command="{Binding ClearCommand}" CommandParameter="{Binding ElementName=RadioButtonGroup}" Margin="5" FontSize="16" FontWeight="Bold" Height="55"/>
        </StackPanel>-->
        </Grid>
    </ScrollViewer>
</UserControl>
